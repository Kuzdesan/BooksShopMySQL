# BooksShopMySQL
<h2> Diagram </h2>

![shop4](https://user-images.githubusercontent.com/99547319/235005779-5c05646d-c2a2-4cb8-933b-a573a49738d4.jpg)

<h3> Задание 1 </h3>
Вывести все заказы Баранова Павла (id заказа, какие книги, по какой цене и в каком количестве он заказал) в отсортированном по номеру заказа и названиям книг виде.
<h3> Задание 2 </h3>
Посчитать, сколько раз была заказана каждая книга, для книги вывести ее автора (нужно посчитать, в каком количестве заказов фигурирует каждая книга). 
Вывести фамилию и инициалы автора, название книги, последний столбец назвать Количество. 
Результат отсортировать сначала  по фамилиям авторов, а потом по названиям книг.
<h3> Задание 3 </h3>
Вывести города, в которых живут клиенты, оформлявшие заказы в интернет-магазине. Указать количество заказов в каждый город, этот столбец назвать Количество. 
Информацию вывести по убыванию количества заказов, а затем в алфавитном порядке по названию городов.
<h3> Задание 4 </h3>
Вывести номера всех оплаченных заказов и даты, когда они были оплачены.
<h3> Задание 5 </h3>
Вывести информацию о каждом заказе: его номер, кто его сформировал (фамилия пользователя) и 
его стоимость (сумма произведений количества заказанных книг и их цены), в отсортированном по номеру заказа виде. 
Последний столбец назвать Стоимость.
<h3> Задание 6 </h3>
Вывести номера заказов (buy_id) и названия этапов, на которых они в данный момент находятся.
Если заказ доставлен –  информацию о нем не выводить. Информацию отсортировать по возрастанию buy_id.
<h3> Задание 7 </h3>
В таблице city для каждого города указано количество дней, за которые заказ может быть доставлен в этот город (рассматривается только этап "Транспортировка"). 
Для тех заказов, которые прошли этап транспортировки, вывести количество дней за которое заказ реально доставлен в город. 
А также, если заказ доставлен с опозданием, указать количество дней задержки, в противном случае вывести 0. 
В результат включить номер заказа (buy_id), а также вычисляемые столбцы Количество_дней и Опоздание. 
Информацию вывести в отсортированном по номеру заказа виде
<h3> Задание 8 </h3>
Выбрать всех клиентов, которые заказывали книги Достоевского, информацию вывести в отсортированном по алфавиту виде.
В решении используйте фамилию автора, а не его id.
<h3> Задание 9 </h3>
Вывести жанр (или жанры), в котором было заказано больше всего экземпляров книг, указать это количество . Последний столбец назвать Количество.
<h3> Задание 10 </h3>
Сравнить ежемесячную выручку от продажи книг за текущий и предыдущий годы. 
Для этого вывести год, месяц, сумму выручки в отсортированном сначала по возрастанию месяцев, затем по возрастанию лет виде.
Название столбцов: Год, Месяц, Сумма.
<h3> Задание 11 </h3>
Для каждой отдельной книги необходимо вывести информацию о количестве проданных экземпляров и их стоимости за 2020 и 2019 год . 
Вычисляемые столбцы назвать Количество и Сумма. Информацию отсортировать по убыванию стоимости.
<h3> Задание 12 </h3>
Уменьшить количество тех книг на складе, которые были включены в заказ с номером 5.
<h3> Задание 13 </h3>
Создать счет (таблицу buy_pay) на оплату заказа с номером 5, в который включить название книг, их автора, цену, количество заказанных книг и  стоимость. 
Последний столбец назвать Стоимость.
Информацию в таблицу занести в отсортированном по названиям книг виде.
<h3> Задание 14 </h3>
Создать общий счет (таблицу buy_pay) на оплату заказа с номером 5. 
Куда включить номер заказа, количество книг в заказе (название столбца Количество) и его общую стоимость (название столбца Итого).  
Для решения используйте ОДИН запрос.
<h3> Задание 15 </h3>
В таблицу buy_step для заказа с номером 5 включить все этапы из таблицы step, которые должен пройти этот заказ. 
В столбцы date_step_beg и date_step_end всех записей занести Null.
<h3> Задание 16 </h3>
<p> 1. Исправить фамилии клиентов, которые заказывали Булгакова, так что если указанного автора заказал Иванов, его фамилия отразилась бы как Бул-Иванов. </p>
<p> 2. В таблицу genre добавить новый жанр - "Экстремизм". </p>
<p> 3. Везде, где автор "Булгаков"  поменять жанр на "Экстремизм" и поднять цену в 10 раз из-за возросшего спроса. </p>

<h3> Задание 17 </h3>
Провести аналитику по трем ценовым категориям (до 600 руб, от 600 руб до 700 руб, свыше 700 руб) и вывести среднюю цену  книги, общую стоимость остатков книг  в этой ценовой позиции и количество позиций. 
Среднюю цену и стоимость округлить до двух знаков после запятой. 
Информацию отсортировать по возрастанию нижней границы ценовой категории.
<h3> Задание 18 </h3>
Удалить из таблиц book и supplyкниги, цены которых заканчиваются на 99 копеек. 
Например, книга с ценой 670.99 должна быть удалена.
<h3> Задание 19 </h3>
Вывести авторов и суммарную стоимость их книг, если хотя бы одна их книга имеет цену выше средней по складу. Средняя цена рассчитывается как простое среднее, с помощью avg(). 
Информацию отсортировать по убыванию суммарной стоимости.
<h3> Задание 20 </h3>
Вывести автора, название, количество, цену (Розничная_цена). 
Для тех книг количество которых больше или равно 10, отобразить оптовую скидку 15% (Скидка), округлить до двух знаков после запятой и вывести оптовую цену с учетом скидки -15% (Оптовая_цена). Все атрибуты перевести на русский язык. 
Отсортировать по автору и названию книги.
<h3> Задание 21 </h3>
Вывести авторов, у которых есть книги со стоимостью более 500 и количеством более 1 шт на складе. 
Учитывать книги только тех авторов, у которых не менее 2-х произведений на складе. Вывести автора, количество различных произведений автора, минимальную цену и количество книг на складе. 
Информацию отсортировать по фамилии автора в алфавитном порядке.
<h3> Задание 22 </h3>
Вывести жанр(ы), в котором было заказано меньше всего экземпляров книг, указать это количество. Учитывать только жанры, в которых была заказана хотя бы одна книга.
При реализации в основном запросе не используйте LIMIT, поскольку жанров с минимальным количеством заказанных книг может быть несколько.
<h3> Задание 23 </h3>
Создать новую таблицу store, в которую занести данные из таблиц book и supply, при условии, что количество книг будет больше среднего количества книг по двум таблицам; если книга есть в обеих таблицах, то стоимость выбрать большую из двух. Отсортировать данные из таблицы их по имени автора в алфавитном порядке и по убыванию цены. Вывести данные из полученной таблицы.
<h3> Задание 24 </h3>
Объявить столбец "категории цены" (price_category): <500 - "низкая", 500 - 700 - "средняя", более 700 - "высокая"
Вывести автора, название, категорию, стоимость (цена * количество), исключив из авторов Есенина, из названий "Белую гвардию". Отсортировать по убыванию стоимости и названию (по возрастанию)
<h3> Задание 25 </h3>
Для нечетного количества книг посчитать разницу максимальной стоимости (цена * количество) и стоимостью всех экземпляров конкретной книги. Отсортировать по этой разнице по убыванию. Вывести название, автора, количество, разницу с максимальной стоимостью.
<h3> Задание 26 </h3>
На распродаже размер скидки устанавливается в зависимости от количества экземпляров книги в магазине и от цены книги: для книг в остатке не менее 5 шт скидка 50%, тогда как для книг в остатке менее 5 шт скидка устанавливается в зависимости от цены (на книги не дешевле 700 руб скидка 20%, на остальные 10%). Два последних столбца назвать Скидка и Цена_со_скидкой.  Последний столбец округлить до двух знаков после запятой.
<h3> Задание 27 </h3>
В связи с повышенным спросом на классическую литературу школьниками в формате "А есть то же самое, но покороче, чтобы читать поменьше?" была выпущена серия "Графоман и. Краткое содержание".
<p>
В выборке: </p>
<p> - к имени автора добавить "Графоман и "; </p>
<p> - к названию книги дописать ". Краткое содержание."; </p>
<p> - цену на новый опус установить 40% от цены оригинала, но не более 250. (Если 40% больше 250, то цена должна быть 250); </p>
<p> - в зависимости от остатка на складе вывести "Спрос": до 3 (включительно) - высокий, до 10 (включительно) - средний, иначе низкий; </p>
<p> - добавить колонку "Наличие" в зависимости от количества: 1-2 шт - очень мало, 3-14 - в наличии, 15 и больше - много; </p>
<p> - отсортировать по цене по возрастанию, затем по Спросу от высокого к низкому, а затем по названию книги в алфавитном порядке. </p>

<h3> Задание 28 </h3>
Для клиентов у которых сумма заказов выше средней по суммам заказов клиентов (общей стоимости всех заказов клиентов), вывести имя, общую сумму всех заказов, количество заказов, количество заказанных книг. Этим клиентам мы предложим специальную программу лояльности! Информацию отсортировать по имени клиентов ( в алфавитном порядке).
<h3> Задание 29 </h3>
При анализе остатков книг на складе было решено дополнительно заказать книги авторов, у которых суммарное число экземпляров книг меньше 10. В таблице должны быть отображены авторы, наименьшее и наибольшее количество их книг.
<h3> Задание 30 </h3>
В последний заказ (таблица buy_book) клиента Баранов Павел добавить по одному экземпляру всех книг Достоевского, которые есть в таблице book.
